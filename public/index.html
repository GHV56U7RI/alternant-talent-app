<!doctype html>
<html lang="fr"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Alternant Talent â€“ Offres</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:20px}
  h1{margin:0 0 8px} section{margin:24px 0} input,button{font-size:16px}
  ul{padding-left:16px} li{margin:8px 0}
</style>

</head><body>
<nav>
  <a href="/students/login.html">Connexion</a>
  <a href="/students/signup.html">Inscription</a>
  <a href="/employers/index.html">Espace entreprise</a>
</nav>
<h1>Alternant Talent</h1>

<section>
  <h2>ðŸ”¥ Offres rÃ©centes (France par dÃ©faut)</h2>
  <input id="q" placeholder="Recherche (ex: data, lyonâ€¦)" style="width:100%;padding:10px;margin:8px 0">
  <button id="search">Rechercher</button>
  <label style="margin-left:8px"><input type="checkbox" id="world"> Monde entier</label>
  <ul id="list"></ul>
</section>

<script>
async function api(path, opts={}) {
  const res = await fetch(path, { credentials:'include', ...opts });
  const txt = await res.text();
  try { return { ok: res.ok, status: res.status, json: JSON.parse(txt) }; }
  catch { return { ok: res.ok, status: res.status, text: txt }; }
}
async function loadJobs(){
  const q = document.querySelector('#q').value.trim();
  const world = document.querySelector('#world').checked ? '&world=1' : '';
  const base = '/api/jobs?limit=20';
  const url = q ? `${base}&q=${encodeURIComponent(q)}${world}` : `${base}${world}`;
  const r = await api(url);
  const ul = document.querySelector('#list'); ul.innerHTML='';
  (r.json?.jobs||[]).forEach(j=>{
    const li = document.createElement('li');
    li.innerHTML = `<b>${j.title}</b> â€” ${j.company} Â· ${j.location} Â· <a href="/r/${encodeURIComponent(j.id)}" target="_blank" rel="noopener">Postuler</a>`;
    ul.appendChild(li);
  });
}
document.querySelector('#search').addEventListener('click', loadJobs);
loadJobs();
</script>
</body></html>
