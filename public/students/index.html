<!doctype html><meta charset="utf-8"/>
<title>Étudiants · Alternant & Talent</title>
<h1>Espace Étudiants</h1>

<form id="signup">
  <h2>Créer un compte</h2>
  <input name="email" type="email" placeholder="email" required>
  <input name="password" type="password" placeholder="mot de passe" required>
  <button>S'inscrire</button>
</form>

<form id="login" style="margin-top:1rem">
  <h2>Se connecter</h2>
  <input name="email" type="email" placeholder="email" required>
  <input name="password" type="password" placeholder="mot de passe" required>
  <button>Connexion</button>
</form>

<pre id="me"></pre>

<script>
async function toJSON(res){ if(!res.ok) throw new Error('HTTP '+res.status); return res.json(); }
signup.onsubmit = async (e) => {
  e.preventDefault();
  const body = Object.fromEntries(new FormData(signup));
  const r = await fetch('/api/student/auth/register',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify(body)}).then(toJSON);
  alert('OK inscrit: '+JSON.stringify(r));
};
login.onsubmit = async (e) => {
  e.preventDefault();
  const body = Object.fromEntries(new FormData(login));
  const r = await fetch('/api/student/auth/login',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify(body)}).then(toJSON);
  alert('Connecté');
  me.textContent = JSON.stringify(await fetch('/api/student/auth/me').then(r=>r.json()), null, 2);
};
</script>

